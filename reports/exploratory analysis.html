<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploratory analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="exploratory analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="exploratory analysis_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="exploratory analysis_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="exploratory analysis_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="exploratory analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="exploratory analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="exploratory analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="exploratory analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="exploratory analysis_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="exploratory analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="exploratory analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="exploratory analysis_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploratory analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="import-and-prep-work" class="level2">
<h2 class="anchored" data-anchor-id="import-and-prep-work">Import and Prep Work</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'plotly' was built under R version 4.3.3</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'shiny' was built under R version 4.3.2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>normalize_aircraft <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">str_to_upper</span>(<span class="fu">str_trim</span>(x))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># quick normalize punctuation / spacing</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> s <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"[–—−]"</span>, <span class="st">"-"</span>) <span class="sc">%&gt;%</span>   <span class="co"># normalize dashes</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"AIRBUS INDUSTRIE</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"BOEING</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"EMBRAER</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">"E"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"MCDONNELL DOUGLAS</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"AIRBUS</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"INDUSTRIE</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">""</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Airbus A320 family</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A319"</span>) <span class="sc">~</span> <span class="st">"A319"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A320"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(s, <span class="st">"200N|</span><span class="sc">\\</span><span class="st">bN</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"A20N"</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A320"</span>) <span class="sc">~</span> <span class="st">"A320"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A321"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(s, <span class="st">"200N|</span><span class="sc">\\</span><span class="st">bN</span><span class="sc">\\</span><span class="st">b|LR"</span>) <span class="sc">~</span> <span class="st">"A21N"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A321"</span>) <span class="sc">~</span> <span class="st">"A321"</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># A220 (often shows as BD-500-1A10/1A11)</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A220-?100|BD-500-1A10"</span>) <span class="sc">~</span> <span class="st">"A221"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A220-?300|BD-500-1A11"</span>) <span class="sc">~</span> <span class="st">"A223"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># A330 (incl neo)</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A330-?200"</span>) <span class="sc">~</span> <span class="st">"A332"</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A330-?300"</span>) <span class="sc">~</span> <span class="st">"A333"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A330-?900"</span>) <span class="sc">~</span> <span class="st">"A339"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># A350</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A359|A350-?900"</span>) <span class="sc">~</span> <span class="st">"A359"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^A35K|A350-?1000"</span>) <span class="sc">~</span> <span class="st">"A35K"</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Boeing 717 / 737 / 757 / 767 / 747 / 777 / 787</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^717-?200"</span>) <span class="sc">~</span> <span class="st">"B712"</span>,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 737 variants</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^B737</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"B737"</span>,</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"737-?400"</span>) <span class="sc">~</span> <span class="st">"B734"</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"737-?800|</span><span class="sc">\\</span><span class="st">bB738</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"B738"</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"737-?900ER"</span>) <span class="sc">~</span> <span class="st">"B739ER"</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"737-?900"</span>) <span class="sc">~</span> <span class="st">"B739"</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"737 MAX 800"</span>) <span class="sc">~</span> <span class="st">"B38M"</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"737 MAX 900"</span>) <span class="sc">~</span> <span class="st">"B39M"</span>,</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^737-300"</span>) <span class="sc">~</span> <span class="st">"B733"</span>,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^737-500"</span>) <span class="sc">~</span> <span class="st">"B735"</span>,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"737-700"</span>) <span class="sc">&amp;</span> <span class="fu">str_detect</span>(s, <span class="st">"MAX|MAX 7"</span>) <span class="sc">~</span> <span class="st">"B37M"</span>,</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 757</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"757-?200"</span>) <span class="sc">~</span> <span class="st">"B752"</span>,</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"757-?300"</span>) <span class="sc">~</span> <span class="st">"B753"</span>,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 767</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"767-?400"</span>) <span class="sc">~</span> <span class="st">"B764"</span>,</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^B767</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"B767"</span>,</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^767</span><span class="sc">\\</span><span class="st">b"</span>)  <span class="sc">~</span> <span class="st">"B767"</span>,</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 747</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"747SP"</span>) <span class="sc">~</span> <span class="st">"B74S"</span>,</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"747-?400"</span>) <span class="sc">~</span> <span class="st">"B744"</span>,</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 777</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"777-?200|</span><span class="sc">\\</span><span class="st">bB777-200</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"B777-200"</span>,</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"777-?300|</span><span class="sc">\\</span><span class="st">bB777-300</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"B777-300"</span>,</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 787</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"787-?800|</span><span class="sc">\\</span><span class="st">bB787-800</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"B787-800"</span>,</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"787-?900|</span><span class="sc">\\</span><span class="st">bB787-900</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"B787-900"</span>,</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"787-?10|</span><span class="sc">\\</span><span class="st">bB787-10</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"B787-10"</span>,</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Embraer</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"^E ?190|</span><span class="sc">\\</span><span class="st">bE190</span><span class="sc">\\</span><span class="st">b"</span>) <span class="sc">~</span> <span class="st">"E190"</span>,</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MD-80 / MD-90 / DC-9</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"DC9.*SUPER 80|MD8[1-9]|MD-?8[1-9]"</span>) <span class="sc">~</span> <span class="st">"MD80"</span>,</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"MD-?90"</span>) <span class="sc">~</span> <span class="st">"MD90"</span>,</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(s, <span class="st">"DC-?9-?50"</span>) <span class="sc">~</span> <span class="st">"DC9-50"</span>,</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"."</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="st">"^[0-9]{4}</span><span class="sc">\\</span><span class="st">.csv$"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>df_all <span class="ot">&lt;-</span> <span class="fu">lapply</span>(files, read_csv) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>aircraft_type_map <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"L_AIRCRAFT_TYPE.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIRCRAFT_TYPE =</span> Code,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIRCRAFT =</span> Description</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIRCRAFT_NORMALIZED =</span> <span class="fu">normalize_aircraft</span>(AIRCRAFT)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="all-u.s.-carriers" class="level2">
<h2 class="anchored" data-anchor-id="all-u.s.-carriers">All U.S. Carriers</h2>
<section id="extracting-dataset" class="level3">
<h3 class="anchored" data-anchor-id="extracting-dataset">Extracting dataset</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Passenger flights only</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df_us_carriers <span class="ot">&lt;-</span> df_all <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    CARRIER <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"F9"</span>, <span class="st">"AA"</span>, <span class="st">"B6"</span>, <span class="st">"DL"</span>, <span class="st">"UA"</span>, <span class="st">"NK"</span>, <span class="st">"AS"</span>, <span class="st">"WN"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    CLASS <span class="sc">==</span> <span class="st">"F"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    DEPARTURES_SCHEDULED, DEPARTURES_PERFORMED, SEATS, PASSENGERS,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    DISTANCE, CARRIER, REGION, ORIGIN, ORIGIN_STATE_ABR,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    DEST, DEST_STATE_ABR, AIRCRAFT_TYPE, YEAR, MONTH</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aircraft_type_map, <span class="at">by =</span> <span class="st">"AIRCRAFT_TYPE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>AIRCRAFT_TYPE,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>AIRCRAFT</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIRCRAFT =</span> AIRCRAFT_NORMALIZED</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">CARRIER_TYPE =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>      CARRIER <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"F9"</span>, <span class="st">"NK"</span>) <span class="sc">~</span> <span class="st">"Ultra low cost carrier"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>      CARRIER <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"B6"</span>, <span class="st">"WN"</span>) <span class="sc">~</span> <span class="st">"Low cost carrier"</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>      CARRIER <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"AA"</span>, <span class="st">"DL"</span>, <span class="st">"UA"</span>, <span class="st">"AS"</span>) <span class="sc">~</span> <span class="st">"Full service carrier"</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="rdu-analysis" class="level3">
<h3 class="anchored" data-anchor-id="rdu-analysis">RDU Analysis</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_rdu_us_carriers <span class="ot">&lt;-</span> df_us_carriers <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    ORIGIN <span class="sc">==</span> <span class="st">"RDU"</span> <span class="sc">|</span> DEST <span class="sc">==</span> <span class="st">"RDU"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    DEPARTURES_PERFORMED <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    DEPARTURES_SCHEDULED <span class="sc">&gt;</span> <span class="dv">3</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    PASSENGERS <span class="sc">&gt;</span> <span class="dv">5</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>df_rdu_us_carrier_routes <span class="ot">&lt;-</span> df_rdu_us_carriers <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, CARRIER, CARRIER_TYPE, ORIGIN, DEST, DISTANCE) <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">departures =</span> <span class="fu">sum</span>(DEPARTURES_PERFORMED, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">passengers =</span> <span class="fu">sum</span>(PASSENGERS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">seats =</span> <span class="fu">sum</span>(SEATS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">other_airport =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      ORIGIN <span class="sc">!=</span> <span class="st">"RDU"</span> <span class="sc">~</span> ORIGIN,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>      DEST <span class="sc">!=</span> <span class="st">"RDU"</span> <span class="sc">~</span> DEST,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">is.na</span>(other_airport))) <span class="sc">%&gt;%</span> </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, other_airport, CARRIER_TYPE, CARRIER, DISTANCE) <span class="sc">%&gt;%</span> </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">departures =</span> <span class="fu">sum</span>(departures),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">passengers =</span> <span class="fu">sum</span>(passengers),</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">seats =</span> <span class="fu">sum</span>(seats),</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">load_factor_airline_per_route_per_year =</span> passengers <span class="sc">/</span> seats <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">capacity_per_departure =</span> seats <span class="sc">/</span> departures,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">passenger_per_departure =</span> passengers <span class="sc">/</span> departures</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'YEAR', 'CARRIER', 'CARRIER_TYPE',
'ORIGIN', 'DEST'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_rdu_us_carrier_routes_competition <span class="ot">&lt;-</span> df_rdu_us_carrier_routes <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, other_airport) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">competitor_same_year =</span> <span class="fu">n_distinct</span>(CARRIER) <span class="sc">-</span> <span class="dv">1</span>L,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ULCC_present =</span> <span class="fu">any</span>(CARRIER_TYPE <span class="sc">==</span> <span class="st">"Ultra low cost carrier"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">load_factor_route_year =</span> <span class="fu">if_else</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(seats, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(passengers, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(seats, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="u.s.-china-flights" class="level2">
<h2 class="anchored" data-anchor-id="u.s.-china-flights">U.S.-China Flights</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_china <span class="ot">&lt;-</span> df_all <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    ORIGIN_COUNTRY <span class="sc">==</span> <span class="st">"CN"</span> <span class="sc">|</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>      DEST_COUNTRY <span class="sc">==</span> <span class="st">"CN"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mainland China only</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for scheduled passenger service, and filtering out non-relevant data fields</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for more than 10 passengers on the route in the particular month</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for more than 1 flight performed per month for regularly scheduled service</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering out airport that we know to not have regularly scheduled U.S.-China passenger service that show up in the data set, like Harbin (HRB) and Pittsburgh (PIT)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>no_known_service_airports <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HRB"</span>, <span class="st">"PIT"</span>, <span class="st">"ANC"</span>, <span class="st">"MSP"</span>, <span class="st">"TUL"</span>, <span class="st">"SYR"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"STL"</span>, <span class="st">"PHL"</span>, <span class="st">"PDX"</span>, <span class="st">"OKC"</span>, <span class="st">"MDT"</span>, <span class="st">"KMG"</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"KHN"</span>, <span class="st">"IAG"</span>, <span class="st">"HSV"</span>, <span class="st">"AFW"</span>, <span class="st">"BHM"</span>, <span class="st">"BNA"</span>, <span class="st">"CDB"</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"CGO"</span>, <span class="st">"CMH"</span>, <span class="st">"DLC"</span>, <span class="st">"ELP"</span>, <span class="st">"GEG"</span>, <span class="st">"GRB"</span>, <span class="st">"HAK"</span>, </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"HET"</span>, <span class="st">"OKC"</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>df_china_passenger <span class="ot">&lt;-</span> df_china <span class="sc">%&gt;%</span> </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    CLASS <span class="sc">==</span> <span class="st">"F"</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">select</span>(</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    DEPARTURES_SCHEDULED, DEPARTURES_PERFORMED, SEATS, PASSENGERS, DISTANCE,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    AIR_TIME, CARRIER, ORIGIN, DEST, AIRCRAFT_TYPE, YEAR, MONTH</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PASSENGERS <span class="sc">&gt;</span> <span class="dv">10</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>         DEPARTURES_PERFORMED <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span>(ORIGIN <span class="sc">%in%</span> no_known_service_airports),</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span>(DEST <span class="sc">%in%</span> no_known_service_airports)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(aircraft_type_map, <span class="at">by =</span> <span class="st">"AIRCRAFT_TYPE"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>AIRCRAFT_TYPE) <span class="sc">%&gt;%</span> </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>AIRCRAFT) <span class="sc">%&gt;%</span> </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">AIRCRAFT =</span> AIRCRAFT_NORMALIZED)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>china_airports <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PVG"</span>, <span class="st">"PEK"</span>, <span class="st">"CTU"</span>, <span class="st">"HGH"</span>, <span class="st">"XIY"</span>, <span class="st">"CAN"</span>, <span class="st">"WUH"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"NKG"</span>, <span class="st">"CTU"</span>, <span class="st">"SZX"</span>, <span class="st">"CSX"</span>, <span class="st">"TNA"</span>, <span class="st">"TAO"</span>, <span class="st">"XIY"</span>, <span class="st">"XMN"</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"CKG"</span>, <span class="st">"FOC"</span>, <span class="st">"SHE"</span>, <span class="st">"TFU"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>us_airports <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SFO"</span>, <span class="st">"LAX"</span>, <span class="st">"JFK"</span>, <span class="st">"SEA"</span>, <span class="st">"DTW"</span>, <span class="st">"EWR"</span>, <span class="st">"BOS"</span>, <span class="st">"ORD"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"SJC"</span>, <span class="st">"IAD"</span>, <span class="st">"IAH"</span>, <span class="st">"DFW"</span>, <span class="st">"LAS"</span>, <span class="st">"ATL"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Continental U.S. only: HNL, GUM, SPN excluded.</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>df_china_passenger_route_departure_performed_by_year <span class="ot">&lt;-</span> df_china_passenger <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ORIGIN, DEST, AIRCRAFT, CARRIER, MONTH) <span class="sc">%&gt;%</span> </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">departures =</span> <span class="fu">sum</span>(DEPARTURES_PERFORMED, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">passengers =</span> <span class="fu">sum</span>(PASSENGERS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">seats =</span> <span class="fu">sum</span>(SEATS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">cn_airport =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      ORIGIN <span class="sc">%in%</span> china_airports <span class="sc">~</span> ORIGIN,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      DEST <span class="sc">%in%</span> china_airports <span class="sc">~</span> DEST,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">us_airport =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>      ORIGIN <span class="sc">%in%</span> us_airports <span class="sc">~</span> ORIGIN,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>      DEST <span class="sc">%in%</span> us_airports <span class="sc">~</span> DEST,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cn_airport), <span class="sc">!</span><span class="fu">is.na</span>(us_airport)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, cn_airport, us_airport, AIRCRAFT, CARRIER, MONTH) <span class="sc">%&gt;%</span> </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">departures =</span> <span class="fu">sum</span>(departures),</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">passengers =</span> <span class="fu">sum</span>(passengers),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">seats =</span> <span class="fu">sum</span>(seats),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">load_factor =</span> passengers <span class="sc">/</span> seats <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">capacity_per_departure =</span> seats <span class="sc">/</span> departures,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">policy_regime =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>      YEAR <span class="sc">&lt;=</span> <span class="dv">2019</span> <span class="sc">~</span> <span class="st">"pre_covid"</span>,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>      YEAR <span class="sc">&gt;=</span> <span class="dv">2020</span> <span class="sc">&amp;</span> YEAR <span class="sc">&lt;=</span> <span class="dv">2022</span> <span class="sc">~</span> <span class="st">"china_lockdown"</span>,</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>      YEAR <span class="sc">&gt;=</span> <span class="dv">2023</span> <span class="sc">~</span> <span class="st">"post_covid"</span>,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">chinese_carrier =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>      CARRIER <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"MF"</span>, <span class="st">"CZ"</span>, <span class="st">"MU"</span>, <span class="st">"3U"</span>, <span class="st">"CA"</span>, <span class="st">"HU"</span>) <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">FALSE</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(load_factor))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'YEAR', 'ORIGIN', 'DEST', 'AIRCRAFT',
'CARRIER'. You can override using the `.groups` argument.</code></pre>
</div>
</div>
<section id="models-for-china-u.s.-flights-responding-to-covid-by-carrier-nationality" class="level3">
<h3 class="anchored" data-anchor-id="models-for-china-u.s.-flights-responding-to-covid-by-carrier-nationality">Models for China-U.S. Flights Responding to COVID by carrier nationality</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>capacity_response_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(seats) <span class="sc">~</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    policy_regime <span class="sc">*</span> chinese_carrier <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(cn_airport) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(us_airport) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(CARRIER) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(YEAR) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(MONTH),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_china_passenger_route_departure_performed_by_year</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>frequency_response_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(departures) <span class="sc">~</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    policy_regime <span class="sc">*</span> chinese_carrier <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(cn_airport) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(us_airport) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(CARRIER) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(YEAR) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(MONTH),</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_china_passenger_route_departure_performed_by_year</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>utilization_response_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  load_factor <span class="sc">~</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    policy_regime <span class="sc">*</span> chinese_carrier <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(cn_airport) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(us_airport) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(CARRIER) <span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(YEAR) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(MONTH),</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_china_passenger_route_departure_performed_by_year</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>strategy_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  capacity_per_departure <span class="sc">~</span> </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    policy_regime <span class="sc">*</span> chinese_carrier <span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(cn_airport) <span class="sc">+</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(us_airport) <span class="sc">+</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(CARRIER) <span class="sc">+</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(YEAR) <span class="sc">+</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(MONTH),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_china_passenger_route_departure_performed_by_year</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(capacity_response_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(seats) ~ policy_regime * chinese_carrier + factor(cn_airport) + 
    factor(us_airport) + factor(CARRIER) + factor(YEAR) + factor(MONTH), 
    data = df_china_passenger_route_departure_performed_by_year)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.7379 -0.1704  0.0934  0.3476  1.4654 

Coefficients: (4 not defined because of singularities)
                                              Estimate Std. Error t value
(Intercept)                                  8.450e+00  2.756e-01  30.659
policy_regimepost_covid                      1.710e+00  1.492e-01  11.456
policy_regimepre_covid                       1.732e+00  1.424e-01  12.165
chinese_carrierTRUE                         -1.262e-01  2.139e-01  -0.590
factor(cn_airport)CKG                       -1.144e+00  2.049e-01  -5.582
factor(cn_airport)CSX                       -1.295e+00  2.066e-01  -6.268
factor(cn_airport)CTU                       -1.401e+00  1.891e-01  -7.407
factor(cn_airport)FOC                       -1.204e+00  2.221e-01  -5.423
factor(cn_airport)HGH                       -1.036e+00  1.016e-01 -10.192
factor(cn_airport)NKG                       -1.579e+00  2.087e-01  -7.563
factor(cn_airport)PEK                       -1.643e-01  1.851e-01  -0.887
factor(cn_airport)PVG                       -2.750e-01  1.854e-01  -1.483
factor(cn_airport)SHE                       -7.604e-01  1.546e-01  -4.920
factor(cn_airport)SZX                       -1.320e+00  1.977e-01  -6.677
factor(cn_airport)TAO                       -1.279e+00  2.035e-01  -6.286
factor(cn_airport)TFU                       -9.947e-02  1.300e-01  -0.765
factor(cn_airport)TNA                       -9.803e-01  1.028e-01  -9.539
factor(cn_airport)WUH                       -4.176e-01  7.514e-02  -5.557
factor(cn_airport)XIY                       -1.347e+00  2.297e-01  -5.865
factor(cn_airport)XMN                       -8.486e-01  2.178e-01  -3.896
factor(us_airport)BOS                       -3.185e-01  1.568e-01  -2.031
factor(us_airport)DFW                       -2.544e-01  1.624e-01  -1.566
factor(us_airport)DTW                       -1.100e-01  1.460e-01  -0.753
factor(us_airport)EWR                       -3.042e-01  1.574e-01  -1.932
factor(us_airport)IAD                       -5.412e-01  1.591e-01  -3.401
factor(us_airport)IAH                       -4.355e-01  1.704e-01  -2.555
factor(us_airport)JFK                        9.382e-02  1.531e-01   0.613
factor(us_airport)LAS                       -9.539e-01  1.763e-01  -5.410
factor(us_airport)LAX                        3.344e-02  1.491e-01   0.224
factor(us_airport)ORD                       -2.597e-01  1.525e-01  -1.703
factor(us_airport)SEA                       -3.011e-01  1.448e-01  -2.079
factor(us_airport)SFO                       -2.559e-01  1.538e-01  -1.664
factor(us_airport)SJC                       -8.179e-01  1.589e-01  -5.146
factor(CARRIER)AA                           -3.201e-01  5.341e-02  -5.993
factor(CARRIER)CA                            3.467e-01  1.835e-01   1.889
factor(CARRIER)CZ                                   NA         NA      NA
factor(CARRIER)DL                           -1.419e-01  6.372e-02  -2.227
factor(CARRIER)HU                           -2.595e-01  1.851e-01  -1.402
factor(CARRIER)MF                            4.327e-01  2.050e-01   2.111
factor(CARRIER)MU                            5.633e-01  1.857e-01   3.034
factor(CARRIER)UA                                   NA         NA      NA
factor(YEAR)2016                             5.006e-03  3.814e-02   0.131
factor(YEAR)2017                            -1.587e-01  3.629e-02  -4.373
factor(YEAR)2018                            -4.239e-02  3.638e-02  -1.165
factor(YEAR)2019                            -6.182e-05  3.678e-02  -0.002
factor(YEAR)2020                             7.492e-01  9.834e-02   7.619
factor(YEAR)2021                             3.768e-01  1.115e-01   3.379
factor(YEAR)2022                                    NA         NA      NA
factor(YEAR)2023                            -5.991e-01  6.400e-02  -9.361
factor(YEAR)2024                             4.172e-02  5.553e-02   0.751
factor(YEAR)2025                                    NA         NA      NA
factor(MONTH)2                              -3.056e-01  4.486e-02  -6.812
factor(MONTH)3                              -1.974e-01  4.509e-02  -4.379
factor(MONTH)4                              -6.272e-02  4.631e-02  -1.354
factor(MONTH)5                              -6.568e-02  4.561e-02  -1.440
factor(MONTH)6                              -1.100e-01  4.533e-02  -2.426
factor(MONTH)7                              -4.020e-02  4.515e-02  -0.890
factor(MONTH)8                               2.011e-02  4.535e-02   0.443
factor(MONTH)9                              -1.041e-01  4.501e-02  -2.314
factor(MONTH)10                             -1.439e-01  4.441e-02  -3.241
factor(MONTH)11                             -1.806e-01  4.565e-02  -3.957
factor(MONTH)12                             -8.982e-02  4.547e-02  -1.976
policy_regimepost_covid:chinese_carrierTRUE -9.599e-01  1.251e-01  -7.672
policy_regimepre_covid:chinese_carrierTRUE  -2.087e-01  1.150e-01  -1.816
                                            Pr(&gt;|t|)    
(Intercept)                                  &lt; 2e-16 ***
policy_regimepost_covid                      &lt; 2e-16 ***
policy_regimepre_covid                       &lt; 2e-16 ***
chinese_carrierTRUE                         0.555124    
factor(cn_airport)CKG                       2.53e-08 ***
factor(cn_airport)CSX                       4.04e-10 ***
factor(cn_airport)CTU                       1.56e-13 ***
factor(cn_airport)FOC                       6.20e-08 ***
factor(cn_airport)HGH                        &lt; 2e-16 ***
factor(cn_airport)NKG                       4.84e-14 ***
factor(cn_airport)PEK                       0.375015    
factor(cn_airport)PVG                       0.138036    
factor(cn_airport)SHE                       9.01e-07 ***
factor(cn_airport)SZX                       2.77e-11 ***
factor(cn_airport)TAO                       3.60e-10 ***
factor(cn_airport)TFU                       0.444364    
factor(cn_airport)TNA                        &lt; 2e-16 ***
factor(cn_airport)WUH                       2.92e-08 ***
factor(cn_airport)XIY                       4.86e-09 ***
factor(cn_airport)XMN                       9.93e-05 ***
factor(us_airport)BOS                       0.042277 *  
factor(us_airport)DFW                       0.117364    
factor(us_airport)DTW                       0.451476    
factor(us_airport)EWR                       0.053450 .  
factor(us_airport)IAD                       0.000677 ***
factor(us_airport)IAH                       0.010648 *  
factor(us_airport)JFK                       0.539977    
factor(us_airport)LAS                       6.67e-08 ***
factor(us_airport)LAX                       0.822525    
factor(us_airport)ORD                       0.088600 .  
factor(us_airport)SEA                       0.037657 *  
factor(us_airport)SFO                       0.096284 .  
factor(us_airport)SJC                       2.78e-07 ***
factor(CARRIER)AA                           2.23e-09 ***
factor(CARRIER)CA                           0.058910 .  
factor(CARRIER)CZ                                 NA    
factor(CARRIER)DL                           0.025994 *  
factor(CARRIER)HU                           0.161013    
factor(CARRIER)MF                           0.034839 *  
factor(CARRIER)MU                           0.002431 ** 
factor(CARRIER)UA                                 NA    
factor(YEAR)2016                            0.895603    
factor(YEAR)2017                            1.25e-05 ***
factor(YEAR)2018                            0.243962    
factor(YEAR)2019                            0.998659    
factor(YEAR)2020                            3.17e-14 ***
factor(YEAR)2021                            0.000735 ***
factor(YEAR)2022                                  NA    
factor(YEAR)2023                             &lt; 2e-16 ***
factor(YEAR)2024                            0.452525    
factor(YEAR)2025                                  NA    
factor(MONTH)2                              1.10e-11 ***
factor(MONTH)3                              1.22e-05 ***
factor(MONTH)4                              0.175721    
factor(MONTH)5                              0.149918    
factor(MONTH)6                              0.015317 *  
factor(MONTH)7                              0.373351    
factor(MONTH)8                              0.657513    
factor(MONTH)9                              0.020738 *  
factor(MONTH)10                             0.001200 ** 
factor(MONTH)11                             7.72e-05 ***
factor(MONTH)12                             0.048275 *  
policy_regimepost_covid:chinese_carrierTRUE 2.10e-14 ***
policy_regimepre_covid:chinese_carrierTRUE  0.069476 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5968 on 4099 degrees of freedom
Multiple R-squared:  0.4749,    Adjusted R-squared:  0.4673 
F-statistic: 62.82 on 59 and 4099 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frequency_response_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(departures) ~ policy_regime * chinese_carrier + 
    factor(cn_airport) + factor(us_airport) + factor(CARRIER) + 
    factor(YEAR) + factor(MONTH), data = df_china_passenger_route_departure_performed_by_year)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.5014 -0.1284  0.1054  0.2996  1.4771 

Coefficients: (4 not defined because of singularities)
                                             Estimate Std. Error t value
(Intercept)                                  2.548557   0.264674   9.629
policy_regimepost_covid                      1.622791   0.143320  11.323
policy_regimepre_covid                       1.763353   0.136750  12.895
chinese_carrierTRUE                         -0.139204   0.205403  -0.678
factor(cn_airport)CKG                       -0.799911   0.196758  -4.065
factor(cn_airport)CSX                       -0.938534   0.198383  -4.731
factor(cn_airport)CTU                       -1.000077   0.181635  -5.506
factor(cn_airport)FOC                       -0.840100   0.213278  -3.939
factor(cn_airport)HGH                       -0.713874   0.097581  -7.316
factor(cn_airport)NKG                       -1.107692   0.200438  -5.526
factor(cn_airport)PEK                        0.050199   0.177791   0.282
factor(cn_airport)PVG                       -0.083750   0.178019  -0.470
factor(cn_airport)SHE                       -0.494032   0.148424  -3.329
factor(cn_airport)SZX                       -0.983402   0.189829  -5.180
factor(cn_airport)TAO                       -0.845997   0.195428  -4.329
factor(cn_airport)TFU                        0.068431   0.124877   0.548
factor(cn_airport)TNA                       -0.696165   0.098683  -7.055
factor(cn_airport)WUH                       -0.244992   0.072161  -3.395
factor(cn_airport)XIY                       -0.941251   0.220560  -4.268
factor(cn_airport)XMN                       -0.449906   0.209164  -2.151
factor(us_airport)BOS                       -0.156573   0.150566  -1.040
factor(us_airport)DFW                       -0.196406   0.155989  -1.259
factor(us_airport)DTW                       -0.154704   0.140248  -1.103
factor(us_airport)EWR                       -0.203828   0.151198  -1.348
factor(us_airport)IAD                       -0.399390   0.152802  -2.614
factor(us_airport)IAH                       -0.364303   0.163660  -2.226
factor(us_airport)JFK                        0.129037   0.147003   0.878
factor(us_airport)LAS                       -0.797227   0.169328  -4.708
factor(us_airport)LAX                        0.052860   0.143169   0.369
factor(us_airport)ORD                       -0.198463   0.146426  -1.355
factor(us_airport)SEA                       -0.110912   0.139053  -0.798
factor(us_airport)SFO                       -0.215574   0.147714  -1.459
factor(us_airport)SJC                       -0.597060   0.152615  -3.912
factor(CARRIER)AA                           -0.152205   0.051292  -2.967
factor(CARRIER)CA                            0.221266   0.176222   1.256
factor(CARRIER)CZ                                  NA         NA      NA
factor(CARRIER)DL                           -0.063296   0.061187  -1.034
factor(CARRIER)HU                           -0.274049   0.177743  -1.542
factor(CARRIER)MF                            0.296710   0.196832   1.507
factor(CARRIER)MU                            0.520891   0.178317   2.921
factor(CARRIER)UA                                  NA         NA      NA
factor(YEAR)2016                             0.007435   0.036630   0.203
factor(YEAR)2017                            -0.170285   0.034850  -4.886
factor(YEAR)2018                            -0.076344   0.034936  -2.185
factor(YEAR)2019                            -0.067980   0.035322  -1.925
factor(YEAR)2020                             0.727822   0.094439   7.707
factor(YEAR)2021                             0.331391   0.107081   3.095
factor(YEAR)2022                                   NA         NA      NA
factor(YEAR)2023                            -0.572961   0.061458  -9.323
factor(YEAR)2024                             0.055751   0.053325   1.045
factor(YEAR)2025                                   NA         NA      NA
factor(MONTH)2                              -0.307803   0.043079  -7.145
factor(MONTH)3                              -0.207710   0.043296  -4.797
factor(MONTH)4                              -0.064093   0.044475  -1.441
factor(MONTH)5                              -0.083145   0.043800  -1.898
factor(MONTH)6                              -0.129080   0.043534  -2.965
factor(MONTH)7                              -0.061602   0.043359  -1.421
factor(MONTH)8                              -0.001641   0.043546  -0.038
factor(MONTH)9                              -0.124076   0.043226  -2.870
factor(MONTH)10                             -0.157619   0.042643  -3.696
factor(MONTH)11                             -0.193086   0.043837  -4.405
factor(MONTH)12                             -0.108223   0.043660  -2.479
policy_regimepost_covid:chinese_carrierTRUE -0.900063   0.120152  -7.491
policy_regimepre_covid:chinese_carrierTRUE  -0.179924   0.110389  -1.630
                                            Pr(&gt;|t|)    
(Intercept)                                  &lt; 2e-16 ***
policy_regimepost_covid                      &lt; 2e-16 ***
policy_regimepre_covid                       &lt; 2e-16 ***
chinese_carrierTRUE                         0.497994    
factor(cn_airport)CKG                       4.88e-05 ***
factor(cn_airport)CSX                       2.31e-06 ***
factor(cn_airport)CTU                       3.90e-08 ***
factor(cn_airport)FOC                       8.32e-05 ***
factor(cn_airport)HGH                       3.06e-13 ***
factor(cn_airport)NKG                       3.47e-08 ***
factor(cn_airport)PEK                       0.777689    
factor(cn_airport)PVG                       0.638056    
factor(cn_airport)SHE                       0.000881 ***
factor(cn_airport)SZX                       2.32e-07 ***
factor(cn_airport)TAO                       1.53e-05 ***
factor(cn_airport)TFU                       0.583728    
factor(cn_airport)TNA                       2.02e-12 ***
factor(cn_airport)WUH                       0.000693 ***
factor(cn_airport)XIY                       2.02e-05 ***
factor(cn_airport)XMN                       0.031536 *  
factor(us_airport)BOS                       0.298451    
factor(us_airport)DFW                       0.208067    
factor(us_airport)DTW                       0.270058    
factor(us_airport)EWR                       0.177704    
factor(us_airport)IAD                       0.008988 ** 
factor(us_airport)IAH                       0.026070 *  
factor(us_airport)JFK                       0.380113    
factor(us_airport)LAS                       2.58e-06 ***
factor(us_airport)LAX                       0.711985    
factor(us_airport)ORD                       0.175369    
factor(us_airport)SEA                       0.425135    
factor(us_airport)SFO                       0.144532    
factor(us_airport)SJC                       9.29e-05 ***
factor(CARRIER)AA                           0.003021 ** 
factor(CARRIER)CA                           0.209327    
factor(CARRIER)CZ                                 NA    
factor(CARRIER)DL                           0.300978    
factor(CARRIER)HU                           0.123193    
factor(CARRIER)MF                           0.131778    
factor(CARRIER)MU                           0.003506 ** 
factor(CARRIER)UA                                 NA    
factor(YEAR)2016                            0.839174    
factor(YEAR)2017                            1.07e-06 ***
factor(YEAR)2018                            0.028926 *  
factor(YEAR)2019                            0.054351 .  
factor(YEAR)2020                            1.61e-14 ***
factor(YEAR)2021                            0.001983 ** 
factor(YEAR)2022                                  NA    
factor(YEAR)2023                             &lt; 2e-16 ***
factor(YEAR)2024                            0.295855    
factor(YEAR)2025                                  NA    
factor(MONTH)2                              1.06e-12 ***
factor(MONTH)3                              1.66e-06 ***
factor(MONTH)4                              0.149629    
factor(MONTH)5                              0.057728 .  
factor(MONTH)6                              0.003044 ** 
factor(MONTH)7                              0.155466    
factor(MONTH)8                              0.969942    
factor(MONTH)9                              0.004121 ** 
factor(MONTH)10                             0.000222 ***
factor(MONTH)11                             1.09e-05 ***
factor(MONTH)12                             0.013224 *  
policy_regimepost_covid:chinese_carrierTRUE 8.32e-14 ***
policy_regimepre_covid:chinese_carrierTRUE  0.103197    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5731 on 4099 degrees of freedom
Multiple R-squared:  0.4691,    Adjusted R-squared:  0.4615 
F-statistic: 61.39 on 59 and 4099 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(utilization_response_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = load_factor ~ policy_regime * chinese_carrier + 
    factor(cn_airport) + factor(us_airport) + factor(CARRIER) + 
    factor(YEAR) + factor(MONTH), data = df_china_passenger_route_departure_performed_by_year)

Residuals:
    Min      1Q  Median      3Q     Max 
-78.726  -4.014   1.073   5.161  44.870 

Coefficients: (4 not defined because of singularities)
                                            Estimate Std. Error t value
(Intercept)                                  97.8367     4.3401  22.543
policy_regimepost_covid                      -6.3535     2.3501  -2.703
policy_regimepre_covid                       -3.5145     2.2424  -1.567
chinese_carrierTRUE                         -14.7324     3.3682  -4.374
factor(cn_airport)CKG                       -16.7756     3.2264  -5.199
factor(cn_airport)CSX                       -17.9764     3.2531  -5.526
factor(cn_airport)CTU                       -14.6474     2.9784  -4.918
factor(cn_airport)FOC                        -3.9506     3.4973  -1.130
factor(cn_airport)HGH                       -22.5009     1.6001 -14.062
factor(cn_airport)NKG                       -25.9157     3.2868  -7.885
factor(cn_airport)PEK                        -4.5868     2.9154  -1.573
factor(cn_airport)PVG                        -6.3611     2.9191  -2.179
factor(cn_airport)SHE                         0.1834     2.4338   0.075
factor(cn_airport)SZX                       -12.4885     3.1128  -4.012
factor(cn_airport)TAO                       -23.5581     3.2046  -7.351
factor(cn_airport)TFU                        -5.6275     2.0477  -2.748
factor(cn_airport)TNA                       -26.6910     1.6182 -16.494
factor(cn_airport)WUH                        -6.6667     1.1833  -5.634
factor(cn_airport)XIY                       -18.5000     3.6167  -5.115
factor(cn_airport)XMN                        -7.1533     3.4298  -2.086
factor(us_airport)BOS                        -5.6283     2.4690  -2.280
factor(us_airport)DFW                        -2.3578     2.5579  -0.922
factor(us_airport)DTW                        -3.1755     2.2998  -1.381
factor(us_airport)EWR                        -1.6681     2.4793  -0.673
factor(us_airport)IAD                       -11.3183     2.5056  -4.517
factor(us_airport)IAH                        -2.5290     2.6837  -0.942
factor(us_airport)JFK                        -5.1420     2.4105  -2.133
factor(us_airport)LAS                       -18.6765     2.7766  -6.726
factor(us_airport)LAX                        -2.7535     2.3477  -1.173
factor(us_airport)ORD                        -4.0354     2.4011  -1.681
factor(us_airport)SEA                        -2.7729     2.2802  -1.216
factor(us_airport)SFO                        -3.6307     2.4222  -1.499
factor(us_airport)SJC                       -10.8605     2.5026  -4.340
factor(CARRIER)AA                            -1.5150     0.8411  -1.801
factor(CARRIER)CA                            -0.3095     2.8897  -0.107
factor(CARRIER)CZ                                 NA         NA      NA
factor(CARRIER)DL                             3.7422     1.0033   3.730
factor(CARRIER)HU                            -0.9167     2.9146  -0.315
factor(CARRIER)MF                             1.3495     3.2276   0.418
factor(CARRIER)MU                            -1.0306     2.9240  -0.352
factor(CARRIER)UA                                 NA         NA      NA
factor(YEAR)2016                              1.9073     0.6007   3.175
factor(YEAR)2017                             -1.8399     0.5715  -3.220
factor(YEAR)2018                              0.7724     0.5729   1.348
factor(YEAR)2019                              0.8124     0.5792   1.403
factor(YEAR)2020                            -11.8533     1.5486  -7.654
factor(YEAR)2021                            -14.3258     1.7559  -8.159
factor(YEAR)2022                                  NA         NA      NA
factor(YEAR)2023                             -1.4538     1.0078  -1.443
factor(YEAR)2024                             -0.7161     0.8744  -0.819
factor(YEAR)2025                                  NA         NA      NA
factor(MONTH)2                               -5.2242     0.7064  -7.395
factor(MONTH)3                               -7.5302     0.7100 -10.607
factor(MONTH)4                               -6.4491     0.7293  -8.843
factor(MONTH)5                               -1.9910     0.7182  -2.772
factor(MONTH)6                               -0.4604     0.7139  -0.645
factor(MONTH)7                               -0.8240     0.7110  -1.159
factor(MONTH)8                                1.9028     0.7141   2.665
factor(MONTH)9                               -7.1700     0.7088 -10.115
factor(MONTH)10                              -8.4932     0.6993 -12.146
factor(MONTH)11                              -9.4757     0.7188 -13.182
factor(MONTH)12                              -3.5974     0.7159  -5.025
policy_regimepost_covid:chinese_carrierTRUE  26.7663     1.9702  13.585
policy_regimepre_covid:chinese_carrierTRUE   14.4601     1.8101   7.988
                                            Pr(&gt;|t|)    
(Intercept)                                  &lt; 2e-16 ***
policy_regimepost_covid                     0.006891 ** 
policy_regimepre_covid                      0.117127    
chinese_carrierTRUE                         1.25e-05 ***
factor(cn_airport)CKG                       2.10e-07 ***
factor(cn_airport)CSX                       3.48e-08 ***
factor(cn_airport)CTU                       9.09e-07 ***
factor(cn_airport)FOC                       0.258704    
factor(cn_airport)HGH                        &lt; 2e-16 ***
factor(cn_airport)NKG                       4.01e-15 ***
factor(cn_airport)PEK                       0.115729    
factor(cn_airport)PVG                       0.029382 *  
factor(cn_airport)SHE                       0.939953    
factor(cn_airport)SZX                       6.13e-05 ***
factor(cn_airport)TAO                       2.36e-13 ***
factor(cn_airport)TFU                       0.006019 ** 
factor(cn_airport)TNA                        &lt; 2e-16 ***
factor(cn_airport)WUH                       1.88e-08 ***
factor(cn_airport)XIY                       3.28e-07 ***
factor(cn_airport)XMN                       0.037076 *  
factor(us_airport)BOS                       0.022681 *  
factor(us_airport)DFW                       0.356708    
factor(us_airport)DTW                       0.167413    
factor(us_airport)EWR                       0.501106    
factor(us_airport)IAD                       6.44e-06 ***
factor(us_airport)IAH                       0.346060    
factor(us_airport)JFK                       0.032974 *  
factor(us_airport)LAS                       1.98e-11 ***
factor(us_airport)LAX                       0.240911    
factor(us_airport)ORD                       0.092902 .  
factor(us_airport)SEA                       0.224018    
factor(us_airport)SFO                       0.133970    
factor(us_airport)SJC                       1.46e-05 ***
factor(CARRIER)AA                           0.071746 .  
factor(CARRIER)CA                           0.914724    
factor(CARRIER)CZ                                 NA    
factor(CARRIER)DL                           0.000194 ***
factor(CARRIER)HU                           0.753149    
factor(CARRIER)MF                           0.675894    
factor(CARRIER)MU                           0.724503    
factor(CARRIER)UA                                 NA    
factor(YEAR)2016                            0.001507 ** 
factor(YEAR)2017                            0.001294 ** 
factor(YEAR)2018                            0.177660    
factor(YEAR)2019                            0.160795    
factor(YEAR)2020                            2.41e-14 ***
factor(YEAR)2021                            4.46e-16 ***
factor(YEAR)2022                                  NA    
factor(YEAR)2023                            0.149227    
factor(YEAR)2024                            0.412853    
factor(YEAR)2025                                  NA    
factor(MONTH)2                              1.70e-13 ***
factor(MONTH)3                               &lt; 2e-16 ***
factor(MONTH)4                               &lt; 2e-16 ***
factor(MONTH)5                              0.005594 ** 
factor(MONTH)6                              0.519048    
factor(MONTH)7                              0.246520    
factor(MONTH)8                              0.007733 ** 
factor(MONTH)9                               &lt; 2e-16 ***
factor(MONTH)10                              &lt; 2e-16 ***
factor(MONTH)11                              &lt; 2e-16 ***
factor(MONTH)12                             5.25e-07 ***
policy_regimepost_covid:chinese_carrierTRUE  &lt; 2e-16 ***
policy_regimepre_covid:chinese_carrierTRUE  1.76e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.398 on 4099 degrees of freedom
Multiple R-squared:  0.4967,    Adjusted R-squared:  0.4895 
F-statistic: 68.58 on 59 and 4099 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(strategy_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = capacity_per_departure ~ policy_regime * chinese_carrier + 
    factor(cn_airport) + factor(us_airport) + factor(CARRIER) + 
    factor(YEAR) + factor(MONTH), data = df_china_passenger_route_departure_performed_by_year)

Residuals:
     Min       1Q   Median       3Q      Max 
-269.587  -22.484   -1.842   20.032  147.799 

Coefficients: (4 not defined because of singularities)
                                             Estimate Std. Error t value
(Intercept)                                  373.1741    18.6974  19.959
policy_regimepost_covid                       16.3288    10.1246   1.613
policy_regimepre_covid                       -13.7634     9.6605  -1.425
chinese_carrierTRUE                           11.9924    14.5103   0.826
factor(cn_airport)CKG                       -101.3641    13.8996  -7.293
factor(cn_airport)CSX                       -107.3625    14.0144  -7.661
factor(cn_airport)CTU                       -117.9873    12.8313  -9.195
factor(cn_airport)FOC                       -108.2845    15.0667  -7.187
factor(cn_airport)HGH                       -102.0050     6.8934 -14.797
factor(cn_airport)NKG                       -140.2819    14.1596  -9.907
factor(cn_airport)PEK                        -67.3703    12.5597  -5.364
factor(cn_airport)PVG                        -62.5555    12.5758  -4.974
factor(cn_airport)SHE                        -93.2944    10.4852  -8.898
factor(cn_airport)SZX                       -106.1413    13.4101  -7.915
factor(cn_airport)TAO                       -129.1868    13.8056  -9.358
factor(cn_airport)TFU                        -64.5017     8.8217  -7.312
factor(cn_airport)TNA                        -94.1749     6.9713 -13.509
factor(cn_airport)WUH                        -60.7566     5.0976 -11.919
factor(cn_airport)XIY                       -121.0545    15.5811  -7.769
factor(cn_airport)XMN                       -125.6210    14.7760  -8.502
factor(us_airport)BOS                        -42.4171    10.6365  -3.988
factor(us_airport)DFW                        -13.4928    11.0196  -1.224
factor(us_airport)DTW                         14.5756     9.9075   1.471
factor(us_airport)EWR                        -31.5651    10.6811  -2.955
factor(us_airport)IAD                        -40.9093    10.7944  -3.790
factor(us_airport)IAH                        -22.6757    11.5614  -1.961
factor(us_airport)JFK                        -12.7391    10.3848  -1.227
factor(us_airport)LAS                        -41.6441    11.9619  -3.481
factor(us_airport)LAX                         -2.8816    10.1139  -0.285
factor(us_airport)ORD                        -15.4029    10.3440  -1.489
factor(us_airport)SEA                        -48.7835     9.8231  -4.966
factor(us_airport)SFO                        -10.8038    10.4350  -1.035
factor(us_airport)SJC                        -59.3109    10.7812  -5.501
factor(CARRIER)AA                            -49.7088     3.6235 -13.719
factor(CARRIER)CA                             29.9046    12.4489   2.402
factor(CARRIER)CZ                                  NA         NA      NA
factor(CARRIER)DL                            -24.0941     4.3225  -5.574
factor(CARRIER)HU                             -3.2552    12.5563  -0.259
factor(CARRIER)MF                             30.6471    13.9048   2.204
factor(CARRIER)MU                              5.7243    12.5969   0.454
factor(CARRIER)UA                                  NA         NA      NA
factor(YEAR)2016                              -0.6778     2.5877  -0.262
factor(YEAR)2017                               2.1452     2.4619   0.871
factor(YEAR)2018                               7.4583     2.4680   3.022
factor(YEAR)2019                              16.6384     2.4952   6.668
factor(YEAR)2020                              -2.0782     6.6715  -0.312
factor(YEAR)2021                              11.1762     7.5645   1.477
factor(YEAR)2022                                   NA         NA      NA
factor(YEAR)2023                              -6.8918     4.3416  -1.587
factor(YEAR)2024                              -4.0780     3.7670  -1.083
factor(YEAR)2025                                   NA         NA      NA
factor(MONTH)2                                 0.6519     3.0433   0.214
factor(MONTH)3                                 3.2539     3.0585   1.064
factor(MONTH)4                                 1.2682     3.1419   0.404
factor(MONTH)5                                 5.1117     3.0942   1.652
factor(MONTH)6                                 5.5413     3.0754   1.802
factor(MONTH)7                                 6.2297     3.0630   2.034
factor(MONTH)8                                 6.0918     3.0762   1.980
factor(MONTH)9                                 5.9535     3.0536   1.950
factor(MONTH)10                                3.9997     3.0124   1.328
factor(MONTH)11                                3.5339     3.0968   1.141
factor(MONTH)12                                5.0747     3.0843   1.645
policy_regimepost_covid:chinese_carrierTRUE  -18.4055     8.4879  -2.168
policy_regimepre_covid:chinese_carrierTRUE   -12.1155     7.7982  -1.554
                                            Pr(&gt;|t|)    
(Intercept)                                  &lt; 2e-16 ***
policy_regimepost_covid                     0.106867    
policy_regimepre_covid                      0.154316    
chinese_carrierTRUE                         0.408582    
factor(cn_airport)CKG                       3.63e-13 ***
factor(cn_airport)CSX                       2.29e-14 ***
factor(cn_airport)CTU                        &lt; 2e-16 ***
factor(cn_airport)FOC                       7.83e-13 ***
factor(cn_airport)HGH                        &lt; 2e-16 ***
factor(cn_airport)NKG                        &lt; 2e-16 ***
factor(cn_airport)PEK                       8.59e-08 ***
factor(cn_airport)PVG                       6.82e-07 ***
factor(cn_airport)SHE                        &lt; 2e-16 ***
factor(cn_airport)SZX                       3.16e-15 ***
factor(cn_airport)TAO                        &lt; 2e-16 ***
factor(cn_airport)TFU                       3.16e-13 ***
factor(cn_airport)TNA                        &lt; 2e-16 ***
factor(cn_airport)WUH                        &lt; 2e-16 ***
factor(cn_airport)XIY                       9.90e-15 ***
factor(cn_airport)XMN                        &lt; 2e-16 ***
factor(us_airport)BOS                       6.78e-05 ***
factor(us_airport)DFW                       0.220857    
factor(us_airport)DTW                       0.141325    
factor(us_airport)EWR                       0.003142 ** 
factor(us_airport)IAD                       0.000153 ***
factor(us_airport)IAH                       0.049909 *  
factor(us_airport)JFK                       0.220004    
factor(us_airport)LAS                       0.000504 ***
factor(us_airport)LAX                       0.775725    
factor(us_airport)ORD                       0.136545    
factor(us_airport)SEA                       7.11e-07 ***
factor(us_airport)SFO                       0.300572    
factor(us_airport)SJC                       4.00e-08 ***
factor(CARRIER)AA                            &lt; 2e-16 ***
factor(CARRIER)CA                           0.016341 *  
factor(CARRIER)CZ                                 NA    
factor(CARRIER)DL                           2.65e-08 ***
factor(CARRIER)HU                           0.795460    
factor(CARRIER)MF                           0.027576 *  
factor(CARRIER)MU                           0.649547    
factor(CARRIER)UA                                 NA    
factor(YEAR)2016                            0.793372    
factor(YEAR)2017                            0.383615    
factor(YEAR)2018                            0.002526 ** 
factor(YEAR)2019                            2.94e-11 ***
factor(YEAR)2020                            0.755430    
factor(YEAR)2021                            0.139631    
factor(YEAR)2022                                  NA    
factor(YEAR)2023                            0.112497    
factor(YEAR)2024                            0.279078    
factor(YEAR)2025                                  NA    
factor(MONTH)2                              0.830384    
factor(MONTH)3                              0.287449    
factor(MONTH)4                              0.686505    
factor(MONTH)5                              0.098602 .  
factor(MONTH)6                              0.071647 .  
factor(MONTH)7                              0.042028 *  
factor(MONTH)8                              0.047737 *  
factor(MONTH)9                              0.051286 .  
factor(MONTH)10                             0.184341    
factor(MONTH)11                             0.253870    
factor(MONTH)12                             0.099972 .  
policy_regimepost_covid:chinese_carrierTRUE 0.030183 *  
policy_regimepre_covid:chinese_carrierTRUE  0.120354    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 40.49 on 4099 degrees of freedom
Multiple R-squared:  0.4818,    Adjusted R-squared:  0.4744 
F-statistic: 64.61 on 59 and 4099 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>china_us_load_factor_viz <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  df_china_passenger_route_departure_performed_by_year,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>departures,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>passengers,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span>load_factor_per_airline_per_route_per_year,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="sc">~</span>seats,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">60</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Route:"</span>, cn_airport, <span class="st">"-"</span>, us_airport,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;br&gt;Year:"</span>, YEAR,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;br&gt;Load Factor:"</span>, <span class="fu">round</span>(load_factor_per_airline_per_route_per_year, <span class="dv">1</span>), <span class="st">"%"</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"scatter"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"markers"</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_cn_us_routes_summary_shiny_table <span class="ot">&lt;-</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  df_china_passenger_route_departure_performed_by_year <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">route =</span> <span class="fu">paste</span>(cn_airport, <span class="st">"-"</span>, us_airport)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sliderInput</span>(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"year"</span>, <span class="st">"Year"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(df_cn_us_routes_summary_shiny_table<span class="sc">$</span>YEAR),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(df_cn_us_routes_summary_shiny_table<span class="sc">$</span>YEAR),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">max</span>(df_cn_us_routes_summary_shiny_table<span class="sc">$</span>YEAR),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">step =</span> <span class="dv">1</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotlyOutput</span>(<span class="st">"plot"</span>, <span class="at">height =</span> <span class="st">"600px"</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output) {</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>plot <span class="ot">&lt;-</span> <span class="fu">renderPlotly</span>({</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    df_cn_us_routes_summary_shiny_table <span class="sc">%&gt;%</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(YEAR <span class="sc">==</span> input<span class="sc">$</span>year) <span class="sc">%&gt;%</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot_ly</span>(</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="sc">~</span>departures,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">~</span>passengers,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="sc">~</span>seats,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="sc">~</span>load_factor_per_airline_per_route_per_year,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;b&gt;Route:&lt;/b&gt;"</span>, cn_airport, <span class="st">"–"</span>, us_airport,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;br&gt;&lt;b&gt;Departures:&lt;/b&gt;"</span>, departures,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;br&gt;&lt;b&gt;Passengers:&lt;/b&gt;"</span>, passengers,</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;br&gt;&lt;b&gt;Seats:&lt;/b&gt;"</span>, seats,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;br&gt;&lt;b&gt;Load factor:&lt;/b&gt;"</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>          <span class="fu">round</span>(load_factor_per_airline_per_route_per_year, <span class="dv">1</span>), <span class="st">"%"</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"scatter"</span>,</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">"markers"</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>